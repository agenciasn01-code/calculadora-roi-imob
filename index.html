// Lógica para capturar o formulário e enviar para a planilha
document.getElementById('formCadastro').addEventListener('submit', function(e) {
    e.preventDefault();

    const btn = e.target.querySelector('button');
    const textoOriginal = btn.innerText;
    
    btn.innerText = "Salvando dados... Aguarde";
    btn.disabled = true;

    const dadosLead = {
        nome: document.getElementById('nome').value,
        email: document.getElementById('email').value,
        telefone: document.getElementById('telefone').value,
        profissao: document.getElementById('profissao').value,
        cidade: document.getElementById('cidade').value
    };

    // LINK ATUALIZADO E CORRETO ABAIXO:
    const urlPlanilha = 'https://script.google.com/macros/s/AKfycbzu4_ti2n5hGw2w1A2S9bD3BJWmlrry9Uv0wo0pI2iAyRFsL99B00i4dZtiYwIQW_kX8w/exec'; 

    fetch(urlPlanilha, {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify(dadosLead)
    })
    .then(() => {
        // Sucesso: Libera a calculadora
        document.getElementById('leadForm').classList.add('hidden');
        document.getElementById('calculadoraContainer').classList.remove('hidden');
    })
    .catch(error => {
        console.error("Erro ao enviar:", error);
        alert("Houve um erro ao salvar seus dados. Tente novamente.");
        btn.innerText = textoOriginal;
        btn.disabled = false;
    });
});
