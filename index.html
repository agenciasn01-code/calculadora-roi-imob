// Lógica para capturar o formulário e enviar para a planilha
document.getElementById('formCadastro').addEventListener('submit', function(e) {
    e.preventDefault();

    const btn = e.target.querySelector('button');
    const textoOriginal = btn.innerText;
    
    // Feedback visual para o usuário
    btn.innerText = "Salvando dados... Aguarde";
    btn.disabled = true;

    const dadosLead = {
        nome: document.getElementById('nome').value,
        email: document.getElementById('email').value,
        telefone: document.getElementById('telefone').value,
        profissao: document.getElementById('profissao').value,
        cidade: document.getElementById('cidade').value
    };

    // --- COLOQUE SUA URL DO GOOGLE APPS SCRIPT ABAIXO ---
    const urlPlanilha = 'https://docs.google.com/spreadsheets/d/1ai1Kkn-45ptZhxQ5hg3qMg96d60s3p_63pWSj7dRASg/edit?gid=0#gid=0'; 

    fetch(urlPlanilha, {
        method: 'POST',
        mode: 'no-cors', // Importante para evitar erros de segurança do navegador
        body: JSON.stringify(dadosLead)
    })
    .then(() => {
        // Sucesso: Esconde o formulário e mostra a calculadora
        document.getElementById('leadForm').classList.add('hidden');
        document.getElementById('calculadoraContainer').classList.remove('hidden');
    })
    .catch(error => {
        console.error("Erro ao enviar:", error);
        alert("Houve um erro ao salvar seus dados. Verifique sua conexão e tente novamente.");
        btn.innerText = textoOriginal;
        btn.disabled = false;
    });
});

// Funções da Calculadora (Permanecem iguais)
function formatarMoeda(valor) {
    return valor.toLocaleString('pt-br', { style: 'currency', currency: 'BRL' });
}

function calcular() {
    const inv = parseFloat(document.getElementById('investimento').value);
    const leads = parseFloat(document.getElementById('leads').value);
    const conv = parseFloat(document.getElementById('conversao').value) / 100;
    const valorImovel = parseFloat(document.getElementById('valorImovel').value);
    const comissaoPerc = parseFloat(document.getElementById('comissao').value) / 100;

    if (inv && leads && valorImovel && comissaoPerc) {
        const qtdVendas = Math.floor(leads * conv);
        const receitaTotal = (qtdVendas * valorImovel) * comissaoPerc;
        const roi = (receitaTotal / inv).toFixed(1);

        document.getElementById('resVendas').innerText = `${qtdVendas} venda(s)`;
        document.getElementById('resLucro').innerText = formatarMoeda(receitaTotal);
        document.getElementById('resRoi').innerText = `${roi}x`;
        document.getElementById('resultado').classList.remove('hidden');
    } else {
        alert("Por favor, preencha todos os campos.");
    }
}
